# nmBot 2023 年 1 月功能更新

亲爱的用户，您期盼已久的 nmBot 功能更新现已推出。
本更新包含对 nmBot 底层的重构和对现有功能的改进。本更新还包含错误修复和稳定性提升。

## 2023 年 1 月 13 日 12:14
nmBot 版本号：23.1.2
- 修复了特定情况下，用户名称获取出错时，操作无法继续的问题。
- 关闭了用户在群组中禁止 nmBot 发送消息时，nmBot 的部分告警。

## 2023 年 1 月 13 日 01:42
nmBot 版本号：23.1.1
- 修复了入群验证超时、失败或被管理员拒绝后，nmBot 未正常编辑验证消息的问题。
- 关闭了用户同时发送多条消息时，nmBot 初始化出现数据库重复插入错误时的告警。

## 2023 年 1 月 13 日 00:35
- 重构了 nmBot 底层代码，通过 nmTeam 完全自主研发的全新架构，优化了 nmBot 流畅度，提升了 nmBot 稳定性。
- nmBot 新增多语言支持。nmBot 将自动匹配用户常用的 Telegram 语言；用户也可以发送 /lang 指令切换语言。
- nmBot 新增语言：繁体中文、英语。
  \* 并非所有功能都将以设定的语言呈现。
- 新增“图片转 Emoji”功能：可以使用 /te (/toemoji) 指令将图片转换为贴纸，并可以通过按钮快速转发到其他对话或转发给 @Stickers 等贴纸包机器人。
- nmartChat 需要一段时间组织回复内容时，将通过 Telegram 显示输入状态提示。
- 通过按钮在浏览器同时以多个账号身份打开 nmBot 面板时，用户身份将不再覆盖，可在多个选项卡中同时使用不同用户身份工作。
- 在 nmBot 面板关键词回复设置中可以通过右键单击（电脑端）或长按（手机端）打开上下文菜单并快速删除关键词回复。
- /id 功能新增显示新成员加入、成员退出、新对话名称、新对话头像、删除对话头像、创建群组、创建超级群组、创建频道、迁移到群组、迁移自群组、自动删除消息时间变更、置顶消息、发票、付款、使用 Telegram 护照登录的网站、Telegram 护照数据、接近警报触发、话题创建、话题关闭、话题重启、视频聊天预约、视频聊天开始、视频聊天结束、视频聊天邀请、网页 App 消息等消息类型。
- 群组管理员设置的关键词回复因配置错误发送失败时，nmBot 将发送提示文本。
- /id 功能支持显示视频聊天的持续时间、新的消息自动删除时间、新对话标题、新对话头像 ID、入群成员的信息、媒体是否启用了剧透功能。
- /id 功能增加显示时间的原始时间戳。
- /id 功能将对已销号的用户返回已注销信息。
- 使用 nmBot 面板管理关键词回复的推荐文本添加了直达 nmBot 面板的链接。
- 在 nmBot 面板设置关键词回复时，若设置的禁言时间小于 60 秒，将显示一则警告，询问用户是否要继续操作。
- 执行部分群组管理指令时，增设了群组未启用 nmBot 群组管理功能的提示。
- /pin 功能新增 nmBot 无置顶消息权限的相关提示。
- 在 nmBot 面板新增开放源代码许可展示页。
- 新的 /about 指令将返回 nmBot 的版本号、开发者、链接和帮助等内容。
- 更换了 nmBot 的运行守护进程。
- 取消了自动设置群组默认话题的功能。群组管理员仍可以使用 /dt 指令指定默认话题。
- 群组管理员可以使用 /dt 指令将 Telegram #General 话题设为 nmBot 默认话题。
- nmBot 面板中启用话题功能的群组头像的显示效果现已与 Telegram App 中同步。
- 替换了 nmBot 面板更新日志为 nmBot 帮助文档中的对应章节。
- 调整了“群友互动”功能对消息内容的识别：若互动消息的空格前含有“了”字，消息中将不再附加“了”字。 
- 优化了 nmBot 部分功能的中文文本。
- 优化了 nmBot 群组关键词回复禁言功能的时间配置。
- 更新了 nmBot 的软件包版本。
- 调整了用户通过按钮在浏览器打开 nmBot 面板后，验证 ID 自动从 URL 中隐藏的时间，以便手机端用户切换浏览器。
- 优化了 nmBot 智能识别并删除骚扰消息功能的提示消息在启用话题功能群组中的体验。
- 调整了 nmBot 面板入群欢迎和关键词回复设置中，按钮编辑器的动画速度。
- 修复了 nmBot 欢迎消息按钮中的部分图标错误。
- 修复了使用 /id 功能获取消息信息时，若用户没有设置姓，则名可能无法正常展示的问题。
- 修复了特定情况下，话题创建者在话题中通过 /id 指令获取消息信息时，返回的消息中不包含话题创建者的用户信息的问题。
- 修复了 /mycredit 指令的详情按钮将用户错误导航至群组配置页面，或未导航至积分页面的问题。
- 修复了使用 /spam 指令，通过提供用户 ID 或用户名指定用户时，用户信息被视为举报理由的问题。
- 修复了警告用户负数次和取消警告用户负数次时，显示的警告信息与实际情况不符的问题。
- 修复了使用 /kick 指令时，无论踢出是否成功，都返回踢出成功消息的问题。
- 修复了在与 nmBot 的私信中发送 /sign, /checkin, /hey 指令签到时，nmBot 会错误在一段时间后删除签到消息的问题。
- 修复了群组升级为超级群组时，群组锁定模式设置、存量入群验证、警告数据、入群验证白名单数据未迁移的问题。
- 修复了 nmBot 未正确复读群组中包含特殊格式的消息和包含自定义 Emoji 的消息的问题。（由于 Telegram 限制，nmBot 将不会以非转发形式复读包含自定义 Emoji 的消息，这些消息将始终以转发形式复读。）
- 修复了 nmBot 面板的部分提示未正确显示本地化文本的问题。
- 修复了 nmBot 智能识别并删除骚扰消息功能的“操作时发送提示消息”功能不生效的问题。
- 删除了 nmBot 代码中部分未使用的数据库请求，以节省服务器资源。