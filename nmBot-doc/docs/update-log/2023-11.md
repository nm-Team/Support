# nmBot 2023 年 11 月功能更新

亲爱的用户，您期盼已久的 nmBot 功能更新现已推出。
本更新推出的“自动删除指令消息”功能为管控群组消息提供了简单而强大的解决方案，好懂好方便；“个性化面板颜色”将您的多彩性格真情真释放；全新的积分页面使得您的积分更靓更显眼。本更新还包含对 nmBot 面板的优化、错误修复和稳定性提升。

## 2023 年 11 月 9 日 16:42
nmBot 版本号：23.11.2

- 修复了“自动删除指令消息”功能设为“删除所有指令消息”时，有概率错误删除群组中非指令消息的问题。

## 2023 年 11 月 7 日 22:00
nmBot 版本号：23.11.1

- 修复了特定情况下，对部分名称中特定位置（如末尾）含有 Emoji（如“生如夏花🌸”）的用户返回部分隐藏的用户名中，Emoji 可能被错误截断，导致 Emoji 显示不完整或无法正常显示的问题。[目前针对部分特殊 Emoji（如 🏳️‍⚧️）仍可能存在 Emoji 被错误截断，显示的 Emoji 与实际不匹配的问题，该问题不影响显示的 Emoji 的完整性，我们将尝试在后续修复。]
- 在启用自动删除入群系统消息功能，并启用入群验证功能的群组中，部分名称中特定位置（如末尾）含有 Emoji（如“生如夏花🌸”）的用户在加入群组时，入群验证消息无法正常弹出，用户无法完成验证的问题。
- 修复了对通过 Telegram Login Widget 登录 nmBot 面板的用户，nmBot 面板“积分”页面的积分会员卡无法正常显示的问题。
- 修复了 nmBot“同频气氛组”功能错误识别频道发送的其他类型消息为贴纸消息的问题。
- 删除了部分程序调试输出。

## 2023 年 11 月 7 日 20:40
### 自动删除指令消息
- 推出“自动删除指令消息”功能：nmBot 将识别群组中发送的形如 action@usernameofbot 的指令消息。
- 您可以控制三种 nmBot 识别和删除指令消息的方式：仅删除呼唤 nmBot 的指令消息、删除呼唤 nmBot 和未指定机器人的指令消息、删除所有指令消息。

### 个性化面板颜色
- 您可以更换 nmBot 面板设置项图标的背景颜色，使其和您的个人风格匹配。
- 使用部分背景颜色时，设置项中部分其他元素的颜色也可以发生相应变化，与所选颜色相得益彰。
- 目前提供的设置项图标背景颜色选项：蓝色（默认）、骄傲、彩虹。
- 您可以在 nmBot 面板“设置”页面下“外观”设置项中更改“设置项图标背景颜色”选项。

### 积分页面换新颜
- nmBot 面板“积分”页面中现在显示新的卡片视图，您的积分信息更显眼。
- 您可以点击卡片了解您 nmBot 积分的详细信息。

### 系统优化
- 通过迷你 App 启动 nmBot 面板时，迷你 App 的返回按钮现在将返回到当前页面的上一级，而不是页面历史中的上一个页面。
- nmBot 面板新增服务器选择功能：用户可以在登录页面和“设置”页面选择要使用的服务器。（在当前版本中没有其他服务器供选择。）
- 登录 nmBot 面板时可以取消登录过程。
- nmBot 面板现在将推荐用户订阅 nmBot 频道以获取最新资讯。
- nmBot 面板变更为以宽屏视图显示时，页面将自动滚动到最右侧。
- 在“编辑关键词回复”页面添加关键词回复时，页面将默认显示一条回复内容编辑框。
- 在 nmBot 面板自定义群成员可使用的指令时，列表中现在会依次显示触发某功能的全部可用指令。
- 为 nmBot 面板“群组管理功能”中所有原先为添加图标的“入群验证”设置项、群组页面中同频气氛组“语气偏好”设置项、“编辑关键词回复”页面“匹配以下消息内容”中的设置项添加了图标。

### 其他更新和修复
- 更新了 /privacy 指令的返回消息：该消息中现在将提示关于 nmBot 服务隐私政策的信息。
- 更新了 /about 指令的返回消息：该消息中现在将提示使用 nmBot 即表明您已阅读并同意 nmBot 服务使用条款和隐私政策的信息。
- 优化了“自动识别并删除骚扰消息”和入群验证“自动拒绝骚扰用户入群”功能向用户发送的提示消息：现在可以通过消息内容确认触发的是“自动识别并删除骚扰消息”功能或入群验证“自动拒绝骚扰用户入群”功能，以便 nmBot 管理员执行操作。
- 对 nmBot 内容本地化做出了如下调整和修复：
    - /id 功能的返回消息、nmBot 面板“设置”页面中，“Web App”（或“网页 App”）已更新为“迷你 App”。
    - 修复了使用英文时，nmBot 面板“编辑关键词回复”页面中部分说明文本排版错误的问题。
    - 修复了使用英文时，nmBot 面板“编辑关键词回复”页面中部分设置标题文本格式和语法错误的问题。
    - 修复了使用英文时，nmBot 面板“编辑关键词回复”页面中“贴纸包名称”文本格式错误的问题。
- 优化了 11 个场景下代码的垃圾回收机制。
- 优化了 1 个场景下的缓存数据移除机制。
- 修复了未启用“同频气氛组”功能，且启用 nmartChat 功能时，群组的关联频道在发送含有特定文本内容的消息时，该条消息会误触发 nmartChat 或“同频气氛组”功能的问题。
- 修复了“算术验证”入群验证消息中，验证题目行中有异常空格的问题。
- 修复了 nmBot 面板“积分历史记录”页面中，历史记录名称总是以英语显示的问题。
- 修复了通过刷新页面打开关键词回复编辑页面时，点按“保存”按钮后页面卡死在“正在保存”状态的问题。
- 修复了 /config 功能的返回消息中指向的是旧版 nmBot 面板链接的问题。
- 修复了 /panel 功能的返回消息未回复用户发送的指令消息的问题。
- 修复了 nmBot 管理员查询骚扰举报时，操作按钮中部分信息显示错误的问题。
- 修复了群组转换为超级群组后，部分数据（如举报数据）未迁移到新群组的问题。
